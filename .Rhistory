strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
lambda_past<-read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Miller Lab/Forecasting Models output/clim_lambda_past.csv")
lambda_current<-read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Miller Lab/Forecasting Models output/lambda_current.csv")
lambda_future<-read.csv("/Users/jm200/Library/CloudStorage/Dropbox/Miller Lab/Forecasting Models output/lambda_future.csv")
(lambda_map_past <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lambda_past, aes(x = x, y = y, fill = lambda))+
# geom_point(data=poar_occ_1901_1930,aes(lon, lat))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression(paste(lambda)),
colours = terrain.colors(7))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
(lambda_map_current <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lambda_current, aes(x = x, y = y, fill = lambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression(paste(lambda)),
colours = terrain.colors(7))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="B") )
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prpast_fd,lambda_map_Prcurrent,lambda_map_Prcurrent_fd, lambda_map_Prcmc45,lambda_map_cmc45_fd, lambda_map_Prcmc85,lambda_map_cmc85_fd,common.legend = TRUE)
lambbacurrent <- read.csv("https://www.dropbox.com/scl/fi/5xl6vxw456m942qbtynqi/poar_current_1-400K.csv?rlkey=y76suoez6xbk21xkh52iaym9k&dl=1", stringsAsFactors = F)
lambbapast <- read.csv("https://www.dropbox.com/scl/fi/l1509slfkm5lpecbpscfp/poar_past_1-400K.csv?rlkey=83pxzva68d98qk090kk1kmfkt&dl=1", stringsAsFactors = F)
lambba45 <- read.csv("https://www.dropbox.com/scl/fi/kq7p7zpnr4n910ed9lf1n/poar_miroc45_1-400K.csv?rlkey=0381obcnwjhzjkcx5kj8krmua&dl=1", stringsAsFactors = F)
lambba85 <- read.csv("https://www.dropbox.com/scl/fi/tzat8n3x9dgj4mr2kj2a0/poar_miroc85_1-400K.csv?rlkey=yv10l7v2ii4ljossoviebyp59&dl=1", stringsAsFactors = F)
lambbacmc45 <- read.csv("https://www.dropbox.com/scl/fi/ekjo0ezv0gn2pfoj69blt/poar_cmc45_1-400K.csv?rlkey=25x99ojbmc021qswxl2ehzq3t&dl=1", stringsAsFactors = F)
lambbacmc85 <- read.csv("https://www.dropbox.com/scl/fi/299bagx6imcgm534bcmhs/poar_cmc85_1-400K.csv?rlkey=fd4qs8grnkyua7o99w0oz9pyt&dl=1", stringsAsFactors = F)
lambbaacc45 <- read.csv("https://www.dropbox.com/scl/fi/973dwzsk6y7hzpoov5ljo/poar_acc45_1-400K.csv?rlkey=qsib01gvqjjgmye7pofnmvm7n&dl=1", stringsAsFactors = F)
lambbaacc85 <- read.csv("https://www.dropbox.com/scl/fi/ybt7vyi1693nselqqkxhc/poar_acc85_1-400K.csv?rlkey=pfzooz6p1p0bw2dnvydm2gdzf&dl=1", stringsAsFactors = F)
lambbaces45 <- read.csv("https://www.dropbox.com/scl/fi/8ml4oep2lssgg4xd3eon6/poar_ces45_1-400K.csv?rlkey=71ow2cfxcs6uk7iyqfcdijn1y&dl=1", stringsAsFactors = F)
lambbaces85 <- read.csv("https://www.dropbox.com/scl/fi/84d3crazogxfj5p2id4to/poar_ces85_1-400K.csv?rlkey=raur7uo6w3flwippbrom69uqb&dl=1", stringsAsFactors = F)
lambbapast %>%
unique %>%
pivot_wider(
names_from = posterior_id,
values_from = lambda_diff)->pivot_lambda_past
# Calculate probability of lambda above 1
prob_lambda_past_post<-c()
for(l in 1:nrow(pivot_lambda_past)){
prob_lambda_past_post[l]<-mean(pivot_lambda_past[l,]>1,na.rm=T)
}
lam_prob_past<-data.frame(pivot_lambda_past[,1:8],Prlambda=prob_lambda_past_post)
geo_prlambda_past <- merge(x = lam_prob_past,y =clim_past_values,by=c("pptdorm","tempdorm"), all.x = TRUE)
# summary(geo_prlambda_current)
(lambda_map_Prpast <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-107,-92), ylim = c(25,41)) +
geom_tile(data = geo_prlambda_past, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
lambbacurrent %>%
unique %>%
pivot_wider( values_from = 'lambda_diff',
names_from  = 'posterior_id' )->pivot_lambda_current
dim(pivot_lambda_current)
# Calculate probability of lambda above 1
prob_lambda_current_post<-c()
for(l in 1:nrow(pivot_lambda_current)){
prob_lambda_current_post[l]<-mean(pivot_lambda_current[l,]>1,na.rm=T)
}
lam_prob_current<-data.frame(pivot_lambda_current[,1:8],Prlambda=prob_lambda_current_post)
dim(lam_prob_current)
# summary(geo_prlambda_current)
geo_prlambda_current <- merge(x =lam_prob_current ,y = clim_current_values,by=c("pptdorm","tempdorm"),all.x=TRUE)
geo_prlambda_current <- geo_prlambda_current[complete.cases(geo_prlambda_current), ]
# sum(is.na(geo_prlambda_current$Prlambda))
#
# %>%
#   drop_na("Prlambda","x","y")
# summary(geo_prlambda_current)
(lambda_map_Prcurrent <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = geo_prlambda_current, aes(x = x, y = y, fill = Prlambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="B") )
(lambda_map_Prcmc45 <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = geo_prlambdacmc_45, aes(x = x, y = y, fill = Prlambda))+
# geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Future 4.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(7),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="C") )
(lambda_map_Prcmc85 <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = geo_prlambdacmc_85, aes(x = x, y = y, fill = Prlambda))+
# geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Future 8.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(7))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="D") )
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prpast_fd,lambda_map_Prcurrent,lambda_map_Prcurrent_fd, lambda_map_Prcmc45,lambda_map_cmc45_fd, lambda_map_Prcmc85,lambda_map_cmc85_fd,common.legend = TRUE)
prob_lambda_past_fd<-c()
for(l in 1:ncol(geo_lambbapast_fd)){
prob_lambda_past_fd[l]<-mean(geo_lambbapast_fd[,l]>1,na.rm=T)
}
clim_past_values_clean<-na.omit(clim_past_values)
lam_prob_past_fd<-data.frame(clim_past_values_clean[,9:10],Prlambda=prob_lambda_past_fd)
(lambda_map_Prpast_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-107,-92), ylim = c(25,41)) +
geom_tile(data = lam_prob_past_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
(lambda_map_Prcurrent_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_current_fd, aes(x = x, y = y, fill = Prlambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="B") )
(lambda_map_Prpast_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-107,-92), ylim = c(25,41)) +
geom_tile(data = lam_prob_past_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
prob_lambda_current_fd<-c()
for(l in 1:ncol(geo_lambbacurrent_fd)){
prob_lambda_current_fd[l]<-mean(geo_lambbacurrent_fd[,l]>1,na.rm=T)
}
lam_prob_current_fd<-data.frame(clim_current_values[,9:10],Prlambda=prob_lambda_current_fd)
(lambda_map_Prcurrent_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_current_fd, aes(x = x, y = y, fill = Prlambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="B") )
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prpast_fd,lambda_map_Prcurrent,lambda_map_Prcurrent_fd, lambda_map_Prcmc45,lambda_map_cmc45_fd, lambda_map_Prcmc85,lambda_map_cmc85_fd,common.legend = TRUE)
Fig_geoPrlambdacmc
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prpast_fd,lambda_map_Prcurrent,lambda_map_Prcurrent_fd, lambda_map_Prcmc45,lambda_map_cmc45_fd, lambda_map_Prcmc85,lambda_map_cmc85_fd,common.legend = TRUE,ncol = 4, nrow = 2)
Fig_geoPrlambdacmc
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prcurrent, lambda_map_Prcmc45, lambda_map_Prcmc85,lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd, common.legend = TRUE,ncol = 4, nrow = 2)
Fig_geoPrlambdacmc
Fig_geoPrlambdaprojection_fd_cmc<-ggarrange(lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd,common.legend = TRUE)
Fig_geoPrlambdaprojection_fd_cmc
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prcurrent, lambda_map_Prcmc45, lambda_map_Prcmc85,lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd, common.legend = TRUE,ncol = 4, nrow = 2)
Fig_geoPrlambdacmc
lambbacurrent <- read.csv("https://www.dropbox.com/scl/fi/5xl6vxw456m942qbtynqi/poar_current_1-400K.csv?rlkey=y76suoez6xbk21xkh52iaym9k&dl=1", stringsAsFactors = F)
lambbapast <- read.csv("https://www.dropbox.com/scl/fi/l1509slfkm5lpecbpscfp/poar_past_1-400K.csv?rlkey=83pxzva68d98qk090kk1kmfkt&dl=1", stringsAsFactors = F)
lambba45 <- read.csv("https://www.dropbox.com/scl/fi/kq7p7zpnr4n910ed9lf1n/poar_miroc45_1-400K.csv?rlkey=0381obcnwjhzjkcx5kj8krmua&dl=1", stringsAsFactors = F)
lambba85 <- read.csv("https://www.dropbox.com/scl/fi/tzat8n3x9dgj4mr2kj2a0/poar_miroc85_1-400K.csv?rlkey=yv10l7v2ii4ljossoviebyp59&dl=1", stringsAsFactors = F)
lambbacmc45 <- read.csv("https://www.dropbox.com/scl/fi/ekjo0ezv0gn2pfoj69blt/poar_cmc45_1-400K.csv?rlkey=25x99ojbmc021qswxl2ehzq3t&dl=1", stringsAsFactors = F)
lambbacmc85 <- read.csv("https://www.dropbox.com/scl/fi/299bagx6imcgm534bcmhs/poar_cmc85_1-400K.csv?rlkey=fd4qs8grnkyua7o99w0oz9pyt&dl=1", stringsAsFactors = F)
lambbaacc45 <- read.csv("https://www.dropbox.com/scl/fi/973dwzsk6y7hzpoov5ljo/poar_acc45_1-400K.csv?rlkey=qsib01gvqjjgmye7pofnmvm7n&dl=1", stringsAsFactors = F)
lambbaacc85 <- read.csv("https://www.dropbox.com/scl/fi/ybt7vyi1693nselqqkxhc/poar_acc85_1-400K.csv?rlkey=pfzooz6p1p0bw2dnvydm2gdzf&dl=1", stringsAsFactors = F)
lambbaces45 <- read.csv("https://www.dropbox.com/scl/fi/8ml4oep2lssgg4xd3eon6/poar_ces45_1-400K.csv?rlkey=71ow2cfxcs6uk7iyqfcdijn1y&dl=1", stringsAsFactors = F)
lambbaces85 <- read.csv("https://www.dropbox.com/scl/fi/84d3crazogxfj5p2id4to/poar_ces85_1-400K.csv?rlkey=raur7uo6w3flwippbrom69uqb&dl=1", stringsAsFactors = F)
lambbapast %>%
unique %>%
pivot_wider(
names_from = posterior_id,
values_from = lambda_diff)->pivot_lambda_past
# Calculate probability of lambda above 1
prob_lambda_past_post<-c()
for(l in 1:nrow(pivot_lambda_past)){
prob_lambda_past_post[l]<-mean(pivot_lambda_past[l,]>1,na.rm=T)
}
lam_prob_past<-data.frame(pivot_lambda_past[,1:8],Prlambda=prob_lambda_past_post)
geo_prlambda_past <- merge(x = lam_prob_past,y =clim_past_values,by=c("pptdorm","tempdorm"), all.x = TRUE)
# summary(geo_prlambda_current)
(lambda_map_Prpast <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-107,-92), ylim = c(25,41)) +
geom_tile(data = geo_prlambda_past, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
lambbacurrent %>%
unique %>%
pivot_wider( values_from = 'lambda_diff',
names_from  = 'posterior_id' )->pivot_lambda_current
dim(pivot_lambda_current)
# Calculate probability of lambda above 1
prob_lambda_current_post<-c()
for(l in 1:nrow(pivot_lambda_current)){
prob_lambda_current_post[l]<-mean(pivot_lambda_current[l,]>1,na.rm=T)
}
lam_prob_current<-data.frame(pivot_lambda_current[,1:8],Prlambda=prob_lambda_current_post)
dim(lam_prob_current)
# summary(geo_prlambda_current)
geo_prlambda_current <- merge(x =lam_prob_current ,y = clim_current_values,by=c("pptdorm","tempdorm"),all.x=TRUE)
geo_prlambda_current <- geo_prlambda_current[complete.cases(geo_prlambda_current), ]
# sum(is.na(geo_prlambda_current$Prlambda))
#
# %>%
#   drop_na("Prlambda","x","y")
# summary(geo_prlambda_current)
(lambda_map_Prcurrent <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = geo_prlambda_current, aes(x = x, y = y, fill = Prlambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="B") )
lambbacmc45 %>%
unique %>%
pivot_wider( values_from = 'lambda_diff',
names_from  = 'posterior_id' )->pivot_lambdacmc_45
#dim(pivot_lambda_current)
# Calculate probability of lambda above 1
prob_lambdacmc_45_post<-c()
for(l in 1:nrow(pivot_lambdacmc_45)){
prob_lambdacmc_45_post[l]<-mean(pivot_lambdacmc_45[l,]>1,na.rm=T)
}
lamcmc_prob_45<-data.frame(pivot_lambdacmc_45[,1:8],Prlambda=prob_lambdacmc_45_post)
# class(climate_cmc45_values)
geo_prlambdacmc_45 <- merge(x = lamcmc_prob_45,y =climate_cmc_45_values,by=c("pptdorm","tempdorm"),all.x=TRUE)
# summary(geo_prlambdacmc_45)
(lambda_map_Prcmc45 <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = geo_prlambdacmc_45, aes(x = x, y = y, fill = Prlambda))+
# geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="RCP4.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(7),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="C") )
lambbacmc85 %>%
unique %>%
pivot_wider( values_from = 'lambda_diff',
names_from  = 'posterior_id' )->pivot_lambdacmc_85
#dim(pivot_lambda_current)
# Calculate probability of lambda above 1
prob_lambdacmc_85_post<-c()
for(l in 1:nrow(pivot_lambdacmc_85)){
prob_lambdacmc_85_post[l]<-mean(pivot_lambdacmc_85[l,]>1,na.rm=T)
}
lamcmc_prob_85<-data.frame(pivot_lambdacmc_85[,1:8],Prlambda=prob_lambdacmc_85_post)
geo_prlambdacmc_85 <- merge(x = lamcmc_prob_85,y =climate_cmc_85_values,by=c("pptdorm","tempdorm")) # merge the demographic data with climatic data for each
# summary(geo_prlambda_current)
(lambda_map_Prcmc85 <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = geo_prlambdacmc_85, aes(x = x, y = y, fill = Prlambda))+
# geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="RCP8.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(7))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="D") )
geo_lambbacurrent_fd <- read.csv("https://www.dropbox.com/scl/fi/7zmsid3dxszv3l3tyvoox/lambda_post_current.csv?rlkey=hwy253ls9imsupkzqrduwp7r8&dl=1", stringsAsFactors = F)
geo_lambbapast_fd <- read.csv("https://www.dropbox.com/scl/fi/9x9gbdv1vefdyd292726c/data_past_fd.csv?rlkey=besdw6mj9ab1nubx18if54w9z&dl=1", stringsAsFactors = F)
geo_lambda_miroc45_fd<-read.csv("https://www.dropbox.com/scl/fi/dmfb2mdhrv5k8otcrc33m/lambda_miroc45.csv?rlkey=1d4j1blbmlx9i3rp61c35g7f8&dl=1", stringsAsFactors = F)
geo_lambba_miroc85_fd <- read.csv("https://www.dropbox.com/scl/fi/a1rmqszey6y9s88887fqq/datamiroc85fd.csv?rlkey=1eckoajb6s4ee6dq61f2o5ymj&dl=1", stringsAsFactors = F)
geo_lambba_cmc45_fd <- read.csv("https://www.dropbox.com/scl/fi/oarso87jb6q5c30gsqm3k/lambda_cmcc45_fd.csv?rlkey=w7xlibvxnc2etc3iliog960dq&dl=1", stringsAsFactors = F)
geolambba_cmc85_fd <- read.csv("https://www.dropbox.com/scl/fi/d8uv2mbb2g47ywly0cz63/data_cmc85_fd.csv?rlkey=o4wcrp7hkqmdyow19eue8e1dh&dl=1", stringsAsFactors = F)
geo_lambba_acc45_fd <- read.csv("https://www.dropbox.com/scl/fi/p7xkr30t6zf24gtn4adbl/data_acc45_fd.csv?rlkey=2qv22qe7p3bahmn24mmtff1rm&dl=1", stringsAsFactors = F)
geolambba_acc85_fd <- read.csv("https://www.dropbox.com/scl/fi/5ged79dtckp3z2k570sm8/data_acc85_fd.csv?rlkey=l97zn5wfci6icbbvv8gcj6z5c&dl=1", stringsAsFactors = F)
geo_lambba_ces45_fd <- read.csv("https://www.dropbox.com/scl/fi/zdj4ra2qaghb4y16uiuow/data_ces45_fd.csv?rlkey=wl8t4ih9s48dr674xti0wwwww&dl=1", stringsAsFactors = F)
geolambba_ces85_fd <- read.csv("https://www.dropbox.com/scl/fi/e4mksgd5hpayfwd3oy0sz/data_ces85_fd.csv?rlkey=miacot7xh5yan0vk6nbwk9q1o&dl=1", stringsAsFactors = F)
prob_lambda_past_fd<-c()
for(l in 1:ncol(geo_lambbapast_fd)){
prob_lambda_past_fd[l]<-mean(geo_lambbapast_fd[,l]>1,na.rm=T)
}
clim_past_values_clean<-na.omit(clim_past_values)
lam_prob_past_fd<-data.frame(clim_past_values_clean[,9:10],Prlambda=prob_lambda_past_fd)
(lambda_map_Prpast_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-107,-92), ylim = c(25,41)) +
geom_tile(data = lam_prob_past_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="A") )
prob_lambda_current_fd<-c()
for(l in 1:ncol(geo_lambbacurrent_fd)){
prob_lambda_current_fd[l]<-mean(geo_lambbacurrent_fd[,l]>1,na.rm=T)
}
lam_prob_current_fd<-data.frame(clim_current_values[,9:10],Prlambda=prob_lambda_current_fd)
(lambda_map_Prcurrent_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_current_fd, aes(x = x, y = y, fill = Prlambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="B") )
prob_lambda_cmc45_fd<-c()
dim(geo_lambba_cmc45_fd)
for(l in 1:ncol(geo_lambba_cmc45_fd)){
prob_lambda_cmc45_fd[l]<-mean(geo_lambba_cmc45_fd[,l]>1,na.rm=T)
}
lam_prob_cmc45_fd<-data.frame(climate_cmc_45_values[,9:10],Prlambda=prob_lambda_cmc45_fd)
(lambda_map_cmc45_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_cmc45_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="RCP4.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="C") )
prob_lambda_cmc85_fd<-c()
dim(geolambba_cmc85_fd)
for(l in 1:ncol(geolambba_cmc85_fd)){
prob_lambda_cmc85_fd[l]<-mean(geolambba_cmc85_fd[,l]>1,na.rm=T)
}
lam_prob_cmc85_fd<-data.frame(climate_cmc_85_values[,9:10],Prlambda=prob_lambda_cmc85_fd)
(lambda_map_cmc85_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_cmc85_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="RCP8.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="C") )
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prcurrent, lambda_map_Prcmc45, lambda_map_Prcmc85,lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd, common.legend = TRUE,ncol = 4, nrow = 2)
Fig_geoPrlambdacmc
(lambda_map_cmc85_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_cmc85_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="RCP8.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="H") )
(lambda_map_cmc45_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_cmc45_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="RCP4.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="G") )
(lambda_map_Prcurrent_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_current_fd, aes(x = x, y = y, fill = Prlambda))+
geom_point(data=poar_occ_1990_2019,aes(lon, lat),alpha=1/5)+
annotate(geom="text", x=-100, y=41, label="Current",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="F") )
(lambda_map_Prpast_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-107,-92), ylim = c(25,41)) +
geom_tile(data = lam_prob_past_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="Past",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="E") )
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prcurrent, lambda_map_Prcmc45, lambda_map_Prcmc85,lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd, common.legend = TRUE,ncol = 4, nrow = 2)
Fig_geoPrlambdacmc
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prcurrent, lambda_map_Prcmc45, lambda_map_Prcmc85,lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd, common.legend = TRUE,ncol = 4, nrow = 2)
ggsave("/Users/jm200/Library/CloudStorage/Dropbox/Miller Lab/github/POAR-Forecasting/Manuscript/Figures/Fig_geoPrlambdacmc.pdf", Fig_geoPrlambdacmcprojection, width = 8, height = 6)
Fig_geoPrlambdacmc<-ggarrange(lambda_map_Prpast, lambda_map_Prcurrent, lambda_map_Prcmc45, lambda_map_Prcmc85,lambda_map_Prpast_fd, lambda_map_Prcurrent_fd, lambda_map_cmc45_fd, lambda_map_cmc85_fd, common.legend = TRUE,ncol = 4, nrow = 2)
ggsave("/Users/jm200/Library/CloudStorage/Dropbox/Miller Lab/github/POAR-Forecasting/Manuscript/Figures/Fig_geoPrlambdacmc.pdf", Fig_geoPrlambdacmc, width = 8, height = 6)
(lambda_map_cmc85_fd <- ggplot()+
# geom_map(data = outline_map, map = outline_map, aes(map_id = region), color = "grey", linewidth = .1, fill = "#FAF9F6")+
# coord_sf(xlim = c(-110,-90), ylim = c(25,45)) +
geom_tile(data = lam_prob_cmc85_fd, aes(x = x, y = y, fill = Prlambda))+
annotate(geom="text", x=-100, y=41, label="RCP8.5",
color="grey",size = 3)+
scale_fill_gradientn(
name = expression("Pr " (lambda) > 1),
colours = terrain.colors(10),
breaks = seq(0, 1, 0.2))+
theme_light()+
theme(strip.background = element_blank(),
strip.text  = element_text(face = "italic", color = "black"))+
labs(x = "Longitude", y = "Latitude",title="H") )
